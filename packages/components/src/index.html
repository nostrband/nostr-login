<!doctype html>
<html dir="ltr" lang="ru">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=5.0" />
    <title>Modal Auth Develop</title>
    <script type="module">
      import './build/components.esm.js';

      export const launch = opt => {
        const dialog = document.createElement('dialog');
        const modal = document.createElement('nl-auth');

        dialog.appendChild(modal);
        document.body.appendChild(dialog);

        return new Promise(resolve => {
          modal.addEventListener('handleGetValue', event => {
            const inputValue = event.detail;

            resolve(inputValue);
          });

          modal.addEventListener('handleCloseModal', event => {
            dialog.close();
            const inputValue = event.detail;

            resolve(inputValue);
          });

          dialog.showModal();
          if (opt && opt.theme) {
            modal.setAttribute('theme', opt.theme);
          }

          if (opt && opt.startScreen) {
            modal.setAttribute('start-screen', opt.startScreen);
          }
        });
      };

      const initialModals = async opt => {
        const bunkerUrl = await launch(opt);

        console.log({ bunkerUrl });
      };

      const nlElements = document.getElementsByTagName('nl-button');

      for (let i = 0; i < nlElements.length; i++) {
        const theme = nlElements[i].getAttribute('nl-theme');
        const startScreen = nlElements[i].getAttribute('start-screen');

        nlElements[i].addEventListener('click', function () {
          initialModals({
            theme,
            startScreen,
          });
        });
      }
    </script>
  </head>
  <body>
    <nl-button title-btn="Sign in"></nl-button>
    <!--  <nl-button title-btn="Sign up" start-screen="signup"></nl-button>-->
    <!--  <nl-button nl-theme="ocean"></nl-button>-->
  </body>
</html>
